{% extends 'selene/main.html' %}
{% block title %}Selene - Devices{% endblock %}
{% block body_block %}
{% load static %}
{% load custom_field %}

<div class="title">
    <div class="container">
        <div class="row" style="margin-top: 0px">
            <div class="col-md-10 col-md-offset-2">
                Registro de dispositivos
            </div>
        </div>
    </div>
</div>
<div class="container">

    <script src='{% static "plugins/bootstrap-datepicker/bootstrap-datepicker.js" %}'></script>
    <link rel="stylesheet" type="text/css" href='{% static "plugins/bootstrap-datepicker/bootstrap.css" %}'>
    <form id="device_form" action="device_form" method="POST">
        {% csrf_token %}
        <div class="col-md-8 col-md-offset-2 page-content">
            {% if messages %}
            <div class="row">
                <div class="col-md-12 ">
                    {% for message in messages %}
                    <p class="bg-{% if message.tags != 'success' %}danger{% else %}success{% endif %}">
                        <i class="fa fa-{% if message.tags == 'success' %}check{% else %}times{% endif %}"></i> {{ message }}
                    </p>
                    {% endfor %}
                    {% for error in form.non_field_errors %}
                    <p class="bg-danger">
                        {{ error|escape }}
                    </p>
                    {% endfor %}
                </div>
            </div>
            {% endif %}

            <div class="row">
                <div class="col-md-12 ">
                    <label>Tipo</label>
                    <span class="label-field-error">  {{ form.device_type.errors}}</span>
                </div>
                <div class="col-md-12">
                    {{form.device_type|addcss:"form-control"}}

                </div>
            </div>
            <div class="row">
                <div class="col-md-12 ">
                    <label>Marca</label>
                    <span class="label-field-error">  {{ form.device_brand.errors}}</span>
                </div>
                <div class="col-md-12">
                    {{form.device_brand|addcss:"form-control"}}
                </div>
            </div>
            <div class="row">
                <div class="col-md-12 ">
                    <label>Activo </label>
                    <span class="label-field-error">  {{ form.asset.errors}}</span>
                </div>
                <div class="col-md-12">
                    <button id="si" type="button" class="btn btn-default asset-chk {% if form.asset.value == '1' %}selected{% endif %}" data-value="1">Si</button>
                    <button id="no" type="button" class="btn btn-default asset-chk {% if form.asset.value == '0' %}selected{% endif %}" data-value="0">No</button>
                    {{form.asset}}
                </div>
            </div>
            <div class="row">
                <div class="col-md-12 ">
                    <label>Serial</label>
                    <span class="label-field-error">  {{ form.serial_number.errors}}</span>
                </div>
                <div class="col-md-12">
                    {{form.serial_number|addcss:"form-control"}}

                </div>
            </div>
            <div class="row">
                <div class="col-md-12 ">
                    <label>Modelo</label>
                    <span class="label-field-error">  {{ form.model.errors}}</span>
                </div>
                <div class="col-md-12">
                    {{form.model|addcss:"form-control"}}

                </div>
            </div>
            <div class="row">
                <div class="col-md-12 ">
                    <label>Fecha</label>
                    <span class="label-field-error">  {{ form.purchase_date.errors}}</span>
                </div>
                <div class="col-md-12">
                    {{form.purchase_date|addcss:"form-control"}}

                </div>
            </div>
            <div class="row">
                <div class="col-md-12 ">
                    <label>Propiedad</label>
                    <span class="label-field-error">  {{ form.ownership.errors}}</span>
                </div>
                <div class="col-md-12">
                    {{form.ownership|addcss:"form-control"}}

                </div>
            </div>
            <div class="row">
                <div class="col-md-2">
                    <a href="#" class="btn btn-primary" id="save">
                        <i class="fa fa-save"></i> Guardar
                    </a>
                </div>
            </div>
            <script type="text/javascript">
                $('#id_purchase_date').datepicker({
                format: 'yyyy-mm-dd',
                endDate: 'now'
                });
                $('#save').click(function(){
                    $('#device_form').submit()
                });
                $('.asset-chk').click(function(){
                    var button = $(this);
                    if(button.data('value') == 1){
                     $('#si').addClass('selected');
                     $('#no').removeClass('selected');
                    }
                    else{
                     $('#no').addClass('selected');
                     $('#si').removeClass('selected');
                    }
                    $('#id_asset').val($(this).data('value'));
                });
            </script>
        </div>
    </form>
</div>
{% endblock %}